<div class="section">
  <div class="container">
    <div class="section-main">
      <div class="qna-header">
        <h2>‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶ì ‡¶â‡¶§‡ßç‡¶§‡¶∞ (Q&A)</h2>
        <p>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶ï‡¶∞‡ßÅ‡¶® ‡¶è‡¶¨‡¶Ç AI Bot ‡¶∏‡ßç‡¶¨‡¶Ø‡¶º‡¶Ç‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º‡¶≠‡¶æ‡¶¨‡ßá ‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶¶‡ßá‡¶¨‡ßá</p>
      </div>

      <!-- Tabs for Course and General Questions -->
      <mat-tab-group [(selectedIndex)]="selectedTabIndex" class="qna-tabs" (selectedTabChange)="getAllQuestions()">
        <!-- Course Questions Tab -->
        <mat-tab label="Course">
          <div class="qna-content">
            <!-- Ask Question Form -->
            <div class="ask-question-card">
              <h3>‡¶ï‡ßã‡¶∞‡ßç‡¶∏ ‡¶∏‡¶Æ‡ßç‡¶™‡¶∞‡ßç‡¶ï‡¶ø‡¶§ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</h3>
              <form [formGroup]="courseQuestionForm" (ngSubmit)="onSubmitCourseQuestion()" class="question-form">
                <mat-form-field appearance="outline" class="full-width">
                  <mat-label>‡¶ï‡ßã‡¶∞‡ßç‡¶∏ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</mat-label>
                  <mat-select formControlName="courseId">
                    <mat-option *ngFor="let course of enrolledCourses" [value]="course.orderItem?._id">
                      {{ course.orderItem?.name }}
                    </mat-option>
                  </mat-select>
                  <mat-error *ngIf="courseQuestionForm.get('courseId')?.hasError('required')">
                    ‡¶ï‡ßã‡¶∞‡ßç‡¶∏ ‡¶®‡¶ø‡¶∞‡ßç‡¶¨‡¶æ‡¶ö‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®
                  </mat-error>
                </mat-form-field>

                <mat-form-field appearance="outline" class="full-width">
                  <mat-label>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®</mat-label>
                  <textarea matInput formControlName="question" rows="4" placeholder="‡¶ï‡ßã‡¶∞‡ßç‡¶∏ ‡¶∏‡¶Æ‡ßç‡¶™‡¶∞‡ßç‡¶ï‡ßá ‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®..."></textarea>
                  <mat-error *ngIf="courseQuestionForm.get('question')?.hasError('required')">
                    ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®
                  </mat-error>
                  <mat-error *ngIf="courseQuestionForm.get('question')?.hasError('minlength')">
                    ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®‡¶ü‡¶ø ‡¶ï‡¶Æ‡¶™‡¶ï‡ßç‡¶∑‡ßá ‡ßß‡ß¶ ‡¶Ö‡¶ï‡ßç‡¶∑‡¶∞‡ßá‡¶∞ ‡¶π‡¶§‡ßá ‡¶π‡¶¨‡ßá
                  </mat-error>
                </mat-form-field>

                <button mat-raised-button color="primary" type="submit" [disabled]="isSubmitting || courseQuestionForm.invalid" class="submit-btn">
                  <span *ngIf="!isSubmitting">‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶ú‡¶Æ‡¶æ ‡¶¶‡¶ø‡¶®</span>
                  <span *ngIf="isSubmitting">‡¶ú‡¶Æ‡¶æ ‡¶¶‡ßá‡¶ì‡¶Ø‡¶º‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</span>
                </button>
              </form>
            </div>

            <!-- Questions List -->
            <div class="questions-list">
              <div class="filter-buttons">
                <button mat-button [class.active]="selectedFilter === 'all'" (click)="onFilterChange('all')">
                  ‡¶∏‡¶¨ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®
                </button>
                <button mat-button [class.active]="selectedFilter === 'pending'" (click)="onFilterChange('pending')">
                  ‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶Æ‡¶æ‡¶®
                </button>
                <button mat-button [class.active]="selectedFilter === 'answered'" (click)="onFilterChange('answered')">
                  ‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶¶‡ßá‡¶ì‡¶Ø‡¶º‡¶æ
                </button>
              </div>

              <div class="questions-container" *ngIf="!isLoading">
                <div class="question-card" *ngFor="let question of getFilteredQuestions()">
                  <div class="question-header">
                    <div class="question-info">
                      <h4>{{ question.courseName || '‡¶ï‡ßã‡¶∞‡ßç‡¶∏ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®' }}</h4>
                      <span class="question-date">{{ question.createdAt | date: 'dd MMM yyyy, hh:mm a' }}</span>
                    </div>
                    <div class="question-badges">
                      <span class="badge category-badge">Course</span>
                      <span class="badge status-badge" [ngClass]="question.status">
                        {{ question.status === 'answered' ? '‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶¶‡ßá‡¶ì‡¶Ø‡¶º‡¶æ' : '‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶Æ‡¶æ‡¶®' }}
                      </span>
                      <span class="badge ai-badge" *ngIf="question.answerSource === 'ai'">AI</span>
                    </div>
                  </div>
                  <div class="question-content">
                    <p><strong>‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®:</strong> {{ question.question }}</p>
                  </div>
                  <div class="answer-content" *ngIf="question.answer">
                    <p><strong>‡¶â‡¶§‡ßç‡¶§‡¶∞:</strong> {{ question.answer }}</p>
                    <small *ngIf="question.answerSource === 'ai'" class="ai-note">ü§ñ AI Bot ‡¶¶‡ßç‡¶¨‡¶æ‡¶∞‡¶æ ‡¶∏‡ßç‡¶¨‡¶Ø‡¶º‡¶Ç‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º‡¶≠‡¶æ‡¶¨‡ßá ‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶¶‡ßá‡¶ì‡¶Ø‡¶º‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá</small>
                  </div>
                  <div class="pending-note" *ngIf="!question.answer">
                    <p>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®‡¶ü‡¶ø ‡¶™‡¶∞‡ßç‡¶Ø‡¶æ‡¶≤‡ßã‡¶ö‡¶®‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá‡•§ ‡¶∂‡ßÄ‡¶ò‡ßç‡¶∞‡¶á ‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶¶‡ßá‡¶ì‡¶Ø‡¶º‡¶æ ‡¶π‡¶¨‡ßá‡•§</p>
                  </div>
                </div>

                <div class="no-questions" *ngIf="getFilteredQuestions().length === 0">
                  <p>‡¶ï‡ßã‡¶® ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶®‡ßá‡¶á</p>
                </div>
              </div>

              <div class="loading" *ngIf="isLoading">
                <p>‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</p>
              </div>
            </div>
          </div>
        </mat-tab>

        <!-- General Questions Tab -->
        <mat-tab label="General">
          <div class="qna-content">
            <!-- Ask Question Form -->
            <div class="ask-question-card">
              <h3>‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶ï‡¶∞‡ßÅ‡¶®</h3>
              <form [formGroup]="generalQuestionForm" (ngSubmit)="onSubmitGeneralQuestion()" class="question-form">
                <mat-form-field appearance="outline" class="full-width">
                  <mat-label>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®</mat-label>
                  <textarea matInput formControlName="question" rows="4" placeholder="‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®..."></textarea>
                  <mat-error *ngIf="generalQuestionForm.get('question')?.hasError('required')">
                    ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶≤‡¶ø‡¶ñ‡ßÅ‡¶®
                  </mat-error>
                  <mat-error *ngIf="generalQuestionForm.get('question')?.hasError('minlength')">
                    ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®‡¶ü‡¶ø ‡¶ï‡¶Æ‡¶™‡¶ï‡ßç‡¶∑‡ßá ‡ßß‡ß¶ ‡¶Ö‡¶ï‡ßç‡¶∑‡¶∞‡ßá‡¶∞ ‡¶π‡¶§‡ßá ‡¶π‡¶¨‡ßá
                  </mat-error>
                </mat-form-field>

                <button mat-raised-button color="primary" type="submit" [disabled]="isSubmitting || generalQuestionForm.invalid" class="submit-btn">
                  <span *ngIf="!isSubmitting">‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶ú‡¶Æ‡¶æ ‡¶¶‡¶ø‡¶®</span>
                  <span *ngIf="isSubmitting">‡¶ú‡¶Æ‡¶æ ‡¶¶‡ßá‡¶ì‡¶Ø‡¶º‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</span>
                </button>
              </form>
            </div>

            <!-- Questions List -->
            <div class="questions-list">
              <div class="filter-buttons">
                <button mat-button [class.active]="selectedFilter === 'all'" (click)="onFilterChange('all')">
                  ‡¶∏‡¶¨ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®
                </button>
                <button mat-button [class.active]="selectedFilter === 'pending'" (click)="onFilterChange('pending')">
                  ‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶Æ‡¶æ‡¶®
                </button>
                <button mat-button [class.active]="selectedFilter === 'answered'" (click)="onFilterChange('answered')">
                  ‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶¶‡ßá‡¶ì‡¶Ø‡¶º‡¶æ
                </button>
              </div>

              <div class="questions-container" *ngIf="!isLoading">
                <div class="question-card" *ngFor="let question of getFilteredQuestions()">
                  <div class="question-header">
                    <div class="question-info">
                      <h4>‡¶∏‡¶æ‡¶ß‡¶æ‡¶∞‡¶£ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®</h4>
                      <span class="question-date">{{ question.createdAt | date: 'dd MMM yyyy, hh:mm a' }}</span>
                    </div>
                    <div class="question-badges">
                      <span class="badge category-badge">General</span>
                      <span class="badge status-badge" [ngClass]="question.status">
                        {{ question.status === 'answered' ? '‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶¶‡ßá‡¶ì‡¶Ø‡¶º‡¶æ' : '‡¶Ö‡¶™‡ßá‡¶ï‡ßç‡¶∑‡¶Æ‡¶æ‡¶®' }}
                      </span>
                      <span class="badge ai-badge" *ngIf="question.answerSource === 'ai'">AI</span>
                    </div>
                  </div>
                  <div class="question-content">
                    <p><strong>‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®:</strong> {{ question.question }}</p>
                  </div>
                  <div class="answer-content" *ngIf="question.answer">
                    <p><strong>‡¶â‡¶§‡ßç‡¶§‡¶∞:</strong> {{ question.answer }}</p>
                    <small *ngIf="question.answerSource === 'ai'" class="ai-note">ü§ñ AI Bot ‡¶¶‡ßç‡¶¨‡¶æ‡¶∞‡¶æ ‡¶∏‡ßç‡¶¨‡¶Ø‡¶º‡¶Ç‡¶ï‡ßç‡¶∞‡¶ø‡¶Ø‡¶º‡¶≠‡¶æ‡¶¨‡ßá ‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶¶‡ßá‡¶ì‡¶Ø‡¶º‡¶æ ‡¶π‡¶Ø‡¶º‡ßá‡¶õ‡ßá</small>
                  </div>
                  <div class="pending-note" *ngIf="!question.answer">
                    <p>‡¶Ü‡¶™‡¶®‡¶æ‡¶∞ ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶®‡¶ü‡¶ø ‡¶™‡¶∞‡ßç‡¶Ø‡¶æ‡¶≤‡ßã‡¶ö‡¶®‡¶æ ‡¶ï‡¶∞‡¶æ ‡¶π‡¶ö‡ßç‡¶õ‡ßá‡•§ ‡¶∂‡ßÄ‡¶ò‡ßç‡¶∞‡¶á ‡¶â‡¶§‡ßç‡¶§‡¶∞ ‡¶¶‡ßá‡¶ì‡¶Ø‡¶º‡¶æ ‡¶π‡¶¨‡ßá‡•§</p>
                  </div>
                </div>

                <div class="no-questions" *ngIf="getFilteredQuestions().length === 0">
                  <p>‡¶ï‡ßã‡¶® ‡¶™‡ßç‡¶∞‡¶∂‡ßç‡¶® ‡¶®‡ßá‡¶á</p>
                </div>
              </div>

              <div class="loading" *ngIf="isLoading">
                <p>‡¶≤‡ßã‡¶° ‡¶π‡¶ö‡ßç‡¶õ‡ßá...</p>
              </div>
            </div>
          </div>
        </mat-tab>
      </mat-tab-group>
    </div>
  </div>
</div>

